[TOC]

2018-06-04，由[朱寅](mailto:zhuyin@chinamobile.com)创建。

更新历史：

1. 

# 和指数平台服务端接口设计

## 应用月活查询接口

该接口支持按月、应用类别、TopN-M方式等多种方式筛选，查询应用的月活数据。

查询方式为分页查询。

该接口是GET请求。

### 请求URI

```
app-mau
```

### 请求入参

| 元素     | 类型   | 描述                        | 必选 |
| -------- | ------ | --------------------------- | ---- |
| month    | string | 月份，示例`201712`          | 是   |
| page     | int    | 分页查询的请求页，从1开始   | 是   |
| step     | int    | 分页查询的每页请求数        | 是   |
| category | string | 应用类别，示例` 移动视频类` | 否   |

### 响应出参

| 元素      | 父元素      | 类型          | 描述                            |
| --------- | ----------- | ------------- | ------------------------------- |
| items     | data        | json list对象 | 分页的当前页面记录列表          |
| page      | data        | int           | 分页的当前页面索引，从1开始计数 |
| size      | data        | int           | 分页的当前页面记录数            |
| pageCount | data        | int           | 分页的总页数                    |
| total     | data        | int           | 总记录数                        |
| app       | items的元素 | string        | 应用名称                        |
| mau       | items的元素 | long          | 月活                            |
| logo      | items的元素 | string        | 应用logo图片的base64字符串      |
| category  | items的元素 | string        | 应用类别                        |
| basis     | items的元素 | double        | 环比增长率                      |
| no        | items的元素 | int           | 应用月活排名                    |

### 请求示例

查询2017年12月份的移动视频类的应用月活。

```
http://localhost:18081/api/app-mau?month=201712&page=1&step=10&category=移动视频类
```



```json
{
    "id": "chookin.mac-20180525_162239-0",
    "succeed": true,
    "code": 200,
    "msg": "",
    "data": {
        "items": [{
            "app": "腾讯视频",
            "mau": 581770205,
            "no": 0,
            "logo": "",
            "category": "移动视频类",
            "basis": 0.05
        }, {
            "app": "支付宝",
            "mau": 447152212,
            "no": 1,
            "logo": "",
            "category": "移动支付类",
            "basis": 0.05
        }, {
            "app": "爱奇艺",
            "mau": 375532308,
            "no": 2,
            "logo": "",
            "category": "移动视频类",
            "basis": 0.05
        }],
        "page": 1,
        "pageCount": 1,
        "size": 3,
        "total": 3
    },
    "time": 1527236559855
}
```

### 错误请求示例

#### 1. 缺少入参

请求URL缺少入参`page`。

```
http://localhost:18081/api/app-mau?month=201712&step=10
```

```json
{
    "id": "chookin.mac-20180525_162336-0",
    "succeed": false,
    "code": 400,
    "msg": "java.lang.NullPointerException: page",
    "data": {
        "method": "GET",
        "paras": {
            "month": ["201712"],
            "step": ["10"]
        },
        "path": "/api/app-mau"
    },
    "time": 1527236616757
}
```

#### 2. HTTP Method错误

错误使用了POST方式提交请求。

```json
{
    "id": "chookin.mac-20180525_162519-0",
    "succeed": false,
    "code": 405,
    "msg": "org.springframework.web.HttpRequestMethodNotSupportedException: Request method 'POST' not supported",
    "data": {
        "method": "POST",
        "paras": {
            "month": ["201712"],
            "step": ["10"],
            "page": ["1"]
        },
        "path": "/api/app-mau"
    },
    "time": 1527236719454
}
```
